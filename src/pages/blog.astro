---
import { getCollection } from "astro:content";
import Layout from "../layouts/Layout.astro";
import { siteConfig } from "../config/site";
import { resolveImagePath } from "../utils/images";
import BlogCard from "../components/cards/BlogCard.astro";

const blogPosts = (await getCollection("blog")).sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf(),
);
const { title, description } = siteConfig.sections.blog;
---

<Layout title={title} description={description}>
  {
    blogPosts.map((post) => {
      const imageSrc = resolveImagePath(post.data.image);
      return (
        <BlogCard
          title={post.data.title}
          description={post.data.description}
          href={`/blog/${post.slug}/`}
          image={imageSrc}
        />
      );
    })
  }
</Layout>
